rule01W':
  context: md:EntityDescriptor
  test_rule: |
    normalize-space(text()) = 'urn:oasis:names:tc:SAML:2.0:nameid-format:persistent'
    or normalize-space(text()) = 'urn:oasis:names:tc:SAML:2.0:nameid-format:transient'
    or normalize-space(text()) = ''

  message: @entityID values should be a URI starting with http://, https:// or urn:


rule23E':
  context: alg:DigestMethod
  test_rule: |
    normalize-space(@Algorithm)='http://www.w3.org/2001/04/xmlenc#sha256'
    or normalize-space(@alg:Algorithm)='http://www.w3.org/2001/04/xmlenc#sha256'
    or normalize-space(@Algorithm)='http://www.w3.org/2000/09/xmldsig#sha1'
    or normalize-space(@alg:Algorithm)='http://www.w3.org/2000/09/xmldsig#sha1'
    or normalize-space(@Algorithm)='http://www.w3.org/2001/04/xmlenc#sha512'
    or normalize-space(@alg:Algorithm)='http://www.w3.org/2001/04/xmlenc#sha512'
    or normalize-space(@Algorithm)='http://www.w3.org/2001/04/xmlenc#ripemd160'
    or normalize-space(@alg:Algorithm)='http://www.w3.org/2001/04/xmlenc#ripemd160'

  message: |
    alg:DigestMethod element may only contain following @Algorithm values:
      http://www.w3.org/2000/09/xmldsig#sha1
      http://www.w3.org/2001/04/xmlenc#sha256
      http://www.w3.org/2001/04/xmlenc#sha512
      http://www.w3.org/2001/04/xmlenc#ripemd160
